<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="前言 统一配置：就是将所有的配置信息都以文本的格式存放在git里面，可以随时查看修改记录，以此来帮助我们比较不同配置的差异性，在此基础上不断更"><title>CICD 01</title><link rel=canonical href=https://livenbom.github.io/p/cicd-01/><link rel=stylesheet href=/scss/style.min.07153242ae01e6ce6329b53d084554661fc332542f80176f3e08bc78cd8efd9d.css><meta property="og:title" content="CICD 01"><meta property="og:description" content="前言 统一配置：就是将所有的配置信息都以文本的格式存放在git里面，可以随时查看修改记录，以此来帮助我们比较不同配置的差异性，在此基础上不断更"><meta property="og:url" content="https://livenbom.github.io/p/cicd-01/"><meta property="og:site_name" content="LivenBom's Blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2024-02-04T06:47:17+08:00"><meta property="article:modified_time" content="2024-02-04T06:47:17+08:00"><meta name=twitter:title content="CICD 01"><meta name=twitter:description content="前言 统一配置：就是将所有的配置信息都以文本的格式存放在git里面，可以随时查看修改记录，以此来帮助我们比较不同配置的差异性，在此基础上不断更"><link rel="shortcut icon" href=/img/favicon.ico><script defer src=https://us.umami.is/script.js data-website-id=c6dbd280-e131-498e-9853-4130e53f5cc6></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-474Q86YVSN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-474Q86YVSN",{anonymize_ip:!1})}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#ruby版本控制>Ruby版本控制</a></li><li><a href=#gem版本管理bundle>Gem版本管理Bundle</a></li><li><a href=#fastlane>fastlane</a><ol><li><a href=#自定义lane>自定义lane</a></li><li><a href=#自定义action>自定义action</a></li><li><a href=#fastlane-和-action-的工作目录的區別>fastlane 和 action 的工作目录的區別</a></li><li><a href=#lane的最后一行自动作为返回值>lane的<strong>最后一行</strong>自动作为返回值</a></li><li><a href=#lane_context>lane_context</a><ol><li><a href=#action中如何使用lane_context>action中如何使用lane_context</a></li></ol></li><li><a href=#终止lane的执行>终止lane的执行</a></li><li><a href=#private_lane>private_lane</a></li><li><a href=#lane-hook>lane hook</a></li><li><a href=#通过send调用lane>通过send调用lane</a></li><li><a href=#设置环境变量>设置环境变量</a></li><li><a href=#调用外部命令>调用外部命令</a></li><li><a href=#拼接命令>拼接命令</a></li></ol></li><li><a href=#action>Action</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/cicd-01/>CICD 01</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Feb 04, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 7 分钟</time></div></footer></div></header><section class=article-content><h2 id=前言>前言</h2><p>统一配置：就是将所有的配置信息都以文本的格式存放在git里面，可以随时查看修改记录，以此来帮助我们比较不同配置的差异性，在此基础上不断更新迭代。</p><p>需要使用Ruby工具链来为整个项目搭建一致的开发环境和构建环境。</p><p>为什么选择Ruby呢？因为目前流行的第三方工具CocoaPods和fastlane都是Ruby开发的，并且Ruby有成熟的依赖库管理工具RubyGems和Bundler，其中Bundler可以帮我们有效管理CocoaPods和fastlane的版本。</p><h2 id=ruby版本控制>Ruby版本控制</h2><p><a class=link href=https://brew.idayer.com/ target=_blank rel=noopener>Homebrew</a>安装命令（如果电脑已经安装过的，请忽略）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>/bin/bash -c <span class=s2>&#34;</span><span class=k>$(</span>curl -fsSL https://gitee.com/ineo6/homebrew-install/raw/master/install.sh<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>ruby环境管理工具rbenv安装（如果电脑已经安装过的，请忽略）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>brew install rbenv ruby-build rbenv-vars
</span></span></code></pre></td></tr></table></div></div><p>rbenv安装好之后，需要将下面的设置添加到你的Shell配置文件里，比如~/.bash_profile或者~/.zshrc或者~/.zprofile文件
这样就能保证每次打开终端的时候都会初始化rbenv</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># rbenv</span>
</span></span><span class=line><span class=cl><span class=n>export</span> <span class=no>PATH</span><span class=o>=</span><span class=s2>&#34;$HOME/.rbenv/bin:$PATH&#34;</span> 
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=s2>&#34;$(rbenv init -)&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>为项目指定ruby环境版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=nb>cd</span> <span class=k>$(</span>PROJECT_DIR<span class=k>)</span>
</span></span><span class=line><span class=cl>$ rbenv install 2.7.1
</span></span><span class=line><span class=cl>$ rbenv <span class=nb>local</span> 2.7.1
</span></span></code></pre></td></tr></table></div></div><h2 id=gem版本管理bundle>Gem版本管理Bundle</h2><p>为项目初始化bundle环境</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> <span class=k>$(</span>PROJECT_DIR<span class=k>)</span>
</span></span><span class=line><span class=cl>bundle init
</span></span></code></pre></td></tr></table></div></div><p>修改Gemfile添加需要的gem包，比如fastlane</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>gem &#39;fastlane&#39;, &#39;~&gt; 2.219&#39;
</span></span></code></pre></td></tr></table></div></div><p>安装Gemfile上所有的Gem包: <a class=link href=https://rubygems.org/gems/fastlane target=_blank rel=noopener>Gem资源网站</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bundle install
</span></span></code></pre></td></tr></table></div></div><p>为项目添加fastlane初始化</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bundle <span class=nb>exec</span> fastlane init
</span></span></code></pre></td></tr></table></div></div><p>设置环境变量fastlane才能正常运行，特别是语言环境未设置UTF-8，将会导致构建和上传构建时出现问题</p><p>在**~/.bashrc**、 <strong>/.bash_profile</strong>、 <strong>~/.profile</strong> 或 <strong>~/.zshrc</strong> 根据你电脑对应的bash命令配置文件添加：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LC_ALL</span><span class=o>=</span>en_US.UTF-8
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LANG</span><span class=o>=</span>en_US.UTF-8
</span></span></code></pre></td></tr></table></div></div><p>运行fastlane的lane</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bundle <span class=nb>exec</span> fastlane lane名称
</span></span></code></pre></td></tr></table></div></div><h2 id=fastlane>fastlane</h2><p>命令格式：<code>fastlane **XXX**</code></p><ul><li>fastfile 中的 lane</li><li>自定义action</li><li>自定义plugin</li></ul><p>lane可以调用其他的lane，也可以调用action</p><p>但是action是最小执行单元，不能调用其他的lane，也不能调用其他的action**</p><h3 id=自定义lane>自定义lane</h3><p>my_lane.rb文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># 自定义fastlane的lane</span>
</span></span><span class=line><span class=cl><span class=c1># options 是传入的参数</span>
</span></span><span class=line><span class=cl><span class=c1># 也可以这么写 lane(:my_lane) do |options|</span>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:my_lane</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>  	<span class=c1># 这个可以打印</span>
</span></span><span class=line><span class=cl>    <span class=no>UI</span><span class=o>.</span><span class=n>success</span> <span class=s2>&#34;自定义的lane&#34;</span><span class=o>.</span><span class=n>yellow</span>
</span></span><span class=line><span class=cl>  	<span class=c1># 这个也可以打印</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;自定义的lane&#34;</span><span class=o>.</span><span class=n>blue</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  	<span class=c1># 工作目录：/Users/liven/Documents/Cash/fastlane</span>
</span></span><span class=line><span class=cl>    <span class=c1># 打印当前的目录</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;[my_lane] </span><span class=si>#{</span><span class=no>Dir</span><span class=o>.</span><span class=n>pwd</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 切换到上一级目录</span>
</span></span><span class=line><span class=cl>    <span class=no>Dir</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s2>&#34;..&#34;</span><span class=p>)</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>        <span class=c1># /Users/liven/Documents/Cash</span>
</span></span><span class=line><span class=cl>        <span class=nb>puts</span> <span class=s2>&#34;[my_lane] </span><span class=si>#{</span><span class=no>Dir</span><span class=o>.</span><span class=n>pwd</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>Fastfile文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>default_platform</span><span class=p>(</span><span class=ss>:ios</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果要调用其他文件的lane，必须要要import</span>
</span></span><span class=line><span class=cl><span class=c1># 注意这里要写完整的文件名，包括后缀</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=s1>&#39;my_lane.rb&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>platform</span> <span class=ss>:ios</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=n>desc</span> <span class=s2>&#34;Description of what the lane does&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=n>lane</span> <span class=ss>:custom_lane</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=c1># 在另外一个文件my_lane.rb中定义了lane</span>
</span></span><span class=line><span class=cl>    <span class=c1># lane可以嵌套使用</span>
</span></span><span class=line><span class=cl>    <span class=n>my_lane</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=自定义action>自定义action</h3><p>通过终端的方式创建新的Action</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 第一步：</span>
</span></span><span class=line><span class=cl>bundle <span class=nb>exec</span> fastlane new_action
</span></span><span class=line><span class=cl><span class=c1># 第二步：</span>
</span></span><span class=line><span class=cl><span class=c1># 根据提示输入action的名称就可以了</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=k>module</span> <span class=nn>Fastlane</span>
</span></span><span class=line><span class=cl>  <span class=k>module</span> <span class=nn>Actions</span>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>MyActionAction</span> <span class=o>&lt;</span> <span class=no>Action</span>
</span></span><span class=line><span class=cl>      <span class=c1># 1. 执行的方法</span>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>run</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>name</span> <span class=o>=</span> <span class=n>parames</span><span class=o>[</span><span class=ss>:name</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=n>age</span> <span class=o>=</span> <span class=n>parames</span><span class=o>[</span><span class=ss>:age</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># fastlane will take care of reading in the parameter and fetching the environment variable:</span>
</span></span><span class=line><span class=cl>        <span class=no>UI</span><span class=o>.</span><span class=n>message</span><span class=p>(</span><span class=s2>&#34;Parameter API Token: </span><span class=si>#{</span><span class=nb>name</span><span class=si>}</span><span class=s2> </span><span class=si>#{</span><span class=n>age</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>description</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;A short description with &lt;= 80 characters of what this action does&#39;</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>details</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;You can use this action to do cool things...&#39;</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1># 2. 接受的参数</span>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>available_options</span>
</span></span><span class=line><span class=cl>        <span class=c1># Define all options your action supports.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Below a few examples</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=ss>key</span><span class=p>:</span> <span class=ss>:age</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=ss>description</span><span class=p>:</span> <span class=s1>&#39;API Token for MyActionAction&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=ss>key</span><span class=p>:</span> <span class=ss>:name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                       <span class=ss>description</span><span class=p>:</span> <span class=s1>&#39;Create a development certificate instead of a distribution one&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>output</span>
</span></span><span class=line><span class=cl>        <span class=c1># Define the shared values you are going to provide</span>
</span></span><span class=line><span class=cl>        <span class=c1># Example</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span>
</span></span><span class=line><span class=cl>          <span class=o>[</span><span class=s1>&#39;MY_ACTION_CUSTOM_VALUE&#39;</span><span class=p>,</span> <span class=s1>&#39;A description of what this value contains&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>return_value</span>
</span></span><span class=line><span class=cl>        <span class=c1># If your method provides a return value, you can describe here what it does</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>authors</span>
</span></span><span class=line><span class=cl>        <span class=c1># So no one will ever forget your contribution to fastlane :) You are awesome btw!</span>
</span></span><span class=line><span class=cl>        <span class=o>[</span><span class=s1>&#39;Your GitHub/Twitter Name&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>is_supported?</span><span class=p>(</span><span class=n>platform</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># you can do things like</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=c1>#  true</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=c1>#  platform == :ios</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>        <span class=c1>#  [:ios, :mac].include?(platform)</span>
</span></span><span class=line><span class=cl>        <span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>platform</span> <span class=o>==</span> <span class=ss>:ios</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>action的调用，不需要导入自定义action的文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>platform</span> <span class=ss>:ios</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=n>desc</span> <span class=s2>&#34;Description of what the lane does&#34;</span> 
</span></span><span class=line><span class=cl>  <span class=n>lane</span> <span class=ss>:custom_lane</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=c1># 调用自定义的action</span>
</span></span><span class=line><span class=cl>    <span class=c1># action的名字就是文件名，不需要后缀</span>
</span></span><span class=line><span class=cl>    <span class=n>my_action</span><span class=p>(</span><span class=nb>name</span><span class=p>:</span> <span class=s2>&#34;zhansan&#34;</span><span class=p>,</span> <span class=ss>age</span><span class=p>:</span> <span class=s2>&#34;18&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>命令行执行action</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>bundle <span class=nb>exec</span> fastlane run my_action name:<span class=s1>&#39;zhansan&#39;</span> age:18
</span></span></code></pre></td></tr></table></div></div><h3 id=fastlane-和-action-的工作目录的區別>fastlane 和 action 的工作目录的區別</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># fastlane的工作目录</span>
</span></span><span class=line><span class=cl><span class=c1># /Users/liven/Documents/Cash/fastlane</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># action的工作目錄</span>
</span></span><span class=line><span class=cl><span class=c1># /Users/liven/Documents/Cash</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=lane的最后一行自动作为返回值>lane的<strong>最后一行</strong>自动作为返回值</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:my_lane1</span> <span class=k>do</span> 
</span></span><span class=line><span class=cl> <span class=c1># 打印结果是： 4</span>
</span></span><span class=line><span class=cl> <span class=nb>puts</span> <span class=n>my_lan2</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:my_lane2</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=mi>2</span>
</span></span><span class=line><span class=cl>  <span class=mi>3</span>
</span></span><span class=line><span class=cl>  <span class=n>x</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=lane_context>lane_context</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane1</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=c1># 哈希值</span>
</span></span><span class=line><span class=cl>  <span class=c1># {:DEFAULT_PLATFORM=&gt;:ios, :PLATFORM_NAME=&gt;:ios, :LANE_NAME=&gt;&#34;my_lane&#34;}</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=n>lane_context</span>
</span></span><span class=line><span class=cl>  <span class=c1># 新增一个my_name值</span>
</span></span><span class=line><span class=cl>  <span class=n>lane_context</span><span class=o>[</span><span class=ss>:my_name</span><span class=o>]</span> <span class=o>=</span> <span class=s1>&#39;zhansan&#39;</span>
</span></span><span class=line><span class=cl>  <span class=c1># 调用lane2</span>
</span></span><span class=line><span class=cl>  <span class=n>lane2</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane2</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=c1># 取出my_lane的值： zhansan</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=n>lane_context</span><span class=o>[</span><span class=ss>:my_lane</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><p>炫技写法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># 定一个module</span>
</span></span><span class=line><span class=cl><span class=k>module</span> <span class=nn>MyModule</span>
</span></span><span class=line><span class=cl>  <span class=c1># 还可以是嵌套</span>
</span></span><span class=line><span class=cl>  <span class=k>module</span> <span class=nn>Login</span>
</span></span><span class=line><span class=cl>    <span class=no>MY_NAME</span> <span class=o>=</span> <span class=ss>:my_name</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane1</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=n>lane_context</span><span class=o>[</span><span class=no>MyModule</span><span class=o>::</span><span class=no>Login</span><span class=o>::</span><span class=no>MY_NAME</span><span class=o>]</span> <span class=o>=</span> <span class=s1>&#39;zhansan&#39;</span>
</span></span><span class=line><span class=cl>  <span class=n>lane2</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane2</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=n>lane_context</span><span class=o>[</span><span class=no>MyModule</span><span class=o>::</span><span class=no>Login</span><span class=o>::</span><span class=no>MY_NAME</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=action中如何使用lane_context>action中如何使用lane_context</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=k>module</span> <span class=nn>Fastlane</span>
</span></span><span class=line><span class=cl>  <span class=k>module</span> <span class=nn>Actions</span>
</span></span><span class=line><span class=cl>    <span class=c1># 通过moudle定义共享的变量</span>
</span></span><span class=line><span class=cl>    <span class=k>module</span> <span class=nn>SharedValues</span>
</span></span><span class=line><span class=cl>        <span class=no>MY_NAME</span> <span class=o>=</span> <span class=ss>:MY_NAME</span>
</span></span><span class=line><span class=cl>        <span class=no>MY_AGE</span> <span class=o>=</span> <span class=ss>:MY_AGE</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>ContextAction</span> <span class=o>&lt;</span> <span class=no>Action</span>
</span></span><span class=line><span class=cl>      <span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>run</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 使用lane_context</span>
</span></span><span class=line><span class=cl>        <span class=no>Actions</span><span class=o>.</span><span class=n>lane_context</span><span class=o>[</span><span class=no>Actions</span><span class=o>::</span><span class=no>SharedValues</span><span class=o>::</span><span class=no>MY_NAME</span><span class=o>]</span> <span class=o>=</span> <span class=s2>&#34;zhansan&#34;</span>
</span></span><span class=line><span class=cl>        <span class=no>Actions</span><span class=o>.</span><span class=n>lane_context</span><span class=o>[</span><span class=no>Actions</span><span class=o>::</span><span class=no>SharedValues</span><span class=o>::</span><span class=no>MY_AGE</span><span class=o>]</span> <span class=o>=</span> <span class=s2>&#34;18&#34;</span>
</span></span><span class=line><span class=cl>      <span class=k>end</span>
</span></span><span class=line><span class=cl>    <span class=k>end</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=终止lane的执行>终止lane的执行</h3><p><strong>lane的终止关键字不是return，而是next</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane1</span> <span class=k>do</span> 
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s1>&#39;2&#39;</span> <span class=o>*</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>    <span class=k>next</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s1>&#39;3&#39;</span> <span class=o>*</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:lane2</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s1>&#39;1&#39;</span> <span class=o>*</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>    <span class=n>lane1</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s1>&#39;4&#39;</span> <span class=o>*</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 最后打印的结果</span>
</span></span><span class=line><span class=cl><span class=c1># 1</span>
</span></span><span class=line><span class=cl><span class=c1># 2</span>
</span></span><span class=line><span class=cl><span class=c1># 4</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=private_lane>private_lane</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># private_lane定义的lane只能是在lane之间调用，不能在外部调用，比如在终端直接调用</span>
</span></span><span class=line><span class=cl><span class=n>private_lane</span> <span class=ss>:lane1</span> <span class=k>do</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=lane-hook>lane hook</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>before_all</span> <span class=k>do</span> <span class=o>|</span><span class=n>lane</span><span class=p>,</span> <span class=n>options</span><span class=o>|</span> 
</span></span><span class=line><span class=cl>  <span class=c1># 所有lane开始前会回掉</span>
</span></span><span class=line><span class=cl> 	<span class=no>UI</span><span class=o>.</span><span class=n>message</span><span class=p>(</span><span class=s2>&#34;------------------ [before_all] </span><span class=si>#{</span><span class=n>lane</span><span class=si>}</span><span class=s2> </span><span class=si>#{</span><span class=n>lane</span><span class=o>.</span><span class=n>class</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>before_each</span> <span class=k>do</span> <span class=o>|</span><span class=n>lane</span><span class=p>,</span> <span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=c1># 每一个lane执行之前回回调</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>after_all</span> <span class=k>do</span> <span class=o>|</span><span class=n>lane</span><span class=p>,</span> <span class=n>options</span><span class=o>|</span> 
</span></span><span class=line><span class=cl>  <span class=c1># 所有lane执行完之后会回掉</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>after_each</span> <span class=k>do</span> <span class=o>|</span><span class=n>lane</span><span class=p>,</span> <span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=c1># 每一个lane执行之后回回调</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>error</span> <span class=k>do</span> <span class=o>|</span><span class=n>lane</span><span class=p>,</span> <span class=n>exception</span><span class=p>,</span> <span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=c1># lane执行报错的回调</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>options</span><span class=o>[</span><span class=ss>:debug</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;hi: )&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=通过send调用lane>通过send调用lane</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>private_lane</span> <span class=ss>:pipeline_prepare</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;pipeline_prepare: </span><span class=si>#{</span><span class=n>options</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>blue</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>private_lane</span> <span class=ss>:pipeline_doing</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;pipeline_doing: </span><span class=si>#{</span><span class=n>options</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>blue</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>private_lane</span> <span class=ss>:pipeline_finish</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=s2>&#34;pipeline_finish: </span><span class=si>#{</span><span class=n>options</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>blue</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:pipeline</span> <span class=k>do</span> <span class=o>|</span><span class=n>options</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span> <span class=o>=</span> <span class=n>options</span><span class=o>[</span><span class=ss>:state</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=nb>send</span><span class=p>(</span><span class=s2>&#34;pipeline_</span><span class=si>#{</span><span class=n>state</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>to_sym</span><span class=p>,</span> <span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=设置环境变量>设置环境变量</h3><p>方式一：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># 在Fastlife文件中直接设置</span>
</span></span><span class=line><span class=cl><span class=no>ENV</span><span class=o>[</span><span class=s2>&#34;FASTLANE_PLATFORM_NAME&#34;</span><span class=o>]</span> <span class=o>=</span> <span class=s1>&#39;iOS&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>方式二：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 在终端命令中，export 导出 定义好的 环境变量</span>
</span></span><span class=line><span class=cl><span class=c1># 为了避免不和其他的常量冲突</span>
</span></span><span class=line><span class=cl><span class=c1># 建议添加一个“FASTLANE”前缀</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>NAME</span><span class=o>=</span><span class=s1>&#39;zhansan&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>方式三：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># 通过第三方库：dotenv</span>
</span></span><span class=line><span class=cl><span class=c1># 1. 在 gemfile文件中添加dotenv</span>
</span></span><span class=line><span class=cl><span class=c1># 2. 在fastlane的根目录下创建 .env 文件</span>
</span></span><span class=line><span class=cl><span class=c1># 3. 直接在.env文件中定义key value</span>
</span></span><span class=line><span class=cl><span class=c1># 4. 通过EVN[&#34;key&#34;]就能读取</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=调用外部命令>调用外部命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:hello</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1.</span>
</span></span><span class=line><span class=cl>  <span class=c1># 通过Actions.sh执行的命令会将‘命令的标准输出’赋值给output变量</span>
</span></span><span class=line><span class=cl>  <span class=n>output</span> <span class=o>=</span> <span class=no>Actions</span><span class=o>.</span><span class=n>sh</span><span class=p>(</span><span class=s2>&#34;ls -l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=s2>&#34;output:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=n>output</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 2.</span>
</span></span><span class=line><span class=cl>  <span class=c1># 通过system执行的命令，只返回true或false的值</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=nb>system</span><span class=p>(</span><span class=s2>&#34;ls -l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 3. </span>
</span></span><span class=line><span class=cl>  <span class=c1># 通过反引号执行命令，结果跟Actions.sh 一样</span>
</span></span><span class=line><span class=cl>  <span class=n>pod_cmd</span> <span class=o>=</span> <span class=sb>`ls -l`</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 4.</span>
</span></span><span class=line><span class=cl>  <span class=n>output</span> <span class=o>=</span> <span class=n>sh</span><span class=p>(</span><span class=s2>&#34;ls -l&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=s2>&#34;output:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>puts</span> <span class=n>output</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=拼接命令>拼接命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=c1># 1. 使用 ‘ ’ 拼接</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;ls&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;-l&#34;</span>
</span></span><span class=line><span class=cl><span class=no>Actions</span><span class=o>.</span><span class=n>sh</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 使用 &#39;;&#39; 拼接</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;cd $HOME&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;ls -l&#34;</span>
</span></span><span class=line><span class=cl><span class=no>Actions</span><span class=o>.</span><span class=n>sh</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;;&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 使用 ‘&amp;&amp;’ 拼接</span>
</span></span><span class=line><span class=cl><span class=c1># 这个与第二个的不同是，如果前面的命令报错了，那么后面的命令不会再执行  </span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;cd XXX&#34;</span>
</span></span><span class=line><span class=cl><span class=n>cmds</span> <span class=o>&lt;&lt;</span> <span class=s2>&#34;ls -l&#34;</span>
</span></span><span class=line><span class=cl><span class=no>Action</span><span class=o>.</span><span class=n>sh</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;&amp;&amp;&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=action>Action</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>lane</span> <span class=ss>:hello</span> <span class=k>do</span> 
</span></span><span class=line><span class=cl>  <span class=c1># 创建callback闭包的方式</span>
</span></span><span class=line><span class=cl>  <span class=c1># 1. 通过lambda定义一个闭包</span>
</span></span><span class=line><span class=cl>  <span class=n>callback</span> <span class=o>=</span> <span class=nb>lambda</span> <span class=k>do</span> <span class=o>|</span><span class=n>result</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 2. Proc</span>
</span></span><span class=line><span class=cl>  <span class=n>callback</span> <span class=o>=</span> <span class=no>Proc</span><span class=o>.</span><span class=n>new</span> <span class=k>do</span> <span class=o>|</span><span class=n>result</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=nb>puts</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 3. 推荐</span>
</span></span><span class=line><span class=cl>  <span class=n>callback</span> <span class=o>=</span> <span class=o>-&gt;</span><span class=p>(</span><span class=n>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nb>puts</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># 调用指定的action，传入callback</span>
</span></span><span class=line><span class=cl>  <span class=n>git_clone</span><span class=p>(</span><span class=ss>callback</span><span class=p>:</span> <span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>run</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>callback</span> <span class=o>=</span> <span class=n>params</span><span class=o>[</span><span class=ss>:callback</span><span class=o>]</span>
</span></span><span class=line><span class=cl>	  <span class=c1># if callback如果有callback的话才调用</span>
</span></span><span class=line><span class=cl> 	 	<span class=n>callback</span><span class=o>.</span><span class=n>call</span><span class=p>(</span><span class=o>[</span><span class=s1>&#39;11&#39;</span><span class=p>,</span> <span class=s1>&#39;22&#39;</span><span class=o>]</span><span class=p>)</span> <span class=k>if</span> <span class=n>callback</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>available_options</span>
</span></span><span class=line><span class=cl>  <span class=c1># Define all options your action supports.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Below a few examples</span>
</span></span><span class=line><span class=cl>  <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=c1># string</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:age</span><span class=p>,</span>   <span class=c1># 调用的时候的参数名</span>
</span></span><span class=line><span class=cl>      <span class=ss>env_name</span><span class=p>:</span> <span class=s1>&#39;FL_MY_ACTION_AGE&#39;</span><span class=p>,</span>  <span class=c1># 也可以从环境变量中获取，如果不需要从环境量获取，可以删除</span>
</span></span><span class=line><span class=cl>      <span class=ss>description</span><span class=p>:</span> <span class=s1>&#39;API Token for MyActionAction&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>type</span><span class=p>:</span> <span class=nb>String</span><span class=p>,</span> <span class=c1># 值的类型，可以不写，默认是string</span>
</span></span><span class=line><span class=cl>      <span class=ss>optional</span><span class=p>:</span> <span class=kp>false</span><span class=p>),</span> <span class=c1># 是否是必须的，默认是true</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># boolean</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:hidden</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>type</span><span class=p>:</span> <span class=no>Boolean</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>defaultVale</span><span class=p>:</span> <span class=kp>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>description</span><span class=p>:</span> <span class=s1>&#39;Create a development certificate instead of a distribution one&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># array</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:files</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>type</span><span class=p>:</span> <span class=nb>Array</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>optional</span><span class=p>:</span> <span class=kp>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>description</span><span class=p>:</span> <span class=s1>&#39;Create a development certificate instead of a distribution one&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 多态类型的参数(可以接受多种类型的参数)</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:files</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		  <span class=ss>is_string</span><span class=p>:</span> <span class=kp>false</span><span class=p>,</span> <span class=c1>#通过这个参数设置为false，来指定为多态的参数</span>
</span></span><span class=line><span class=cl>      <span class=ss>verify_block</span><span class=p>:</span> <span class=o>-&gt;</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=p>{</span> <span class=n>verify_option</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=p>}),</span> <span class=c1>#对参数进行校验, 比如说我只希望接受 string，Array，Hash的参数，其他类型的就会报错</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Proc(代码块)</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:callback</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		  <span class=ss>type</span><span class=p>:</span> <span class=no>Proc</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>optional</span><span class=p>:</span> <span class=kp>true</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 互斥参数（只能传其中一个，都传会报错）</span>
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:arg1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		  <span class=ss>type</span><span class=p>:</span> <span class=nb>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>optional</span><span class=p>:</span> <span class=kp>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>conflicting_options</span><span class=p>:</span> <span class=o>[</span><span class=ss>:arg2</span><span class=o>]</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    <span class=no>FastlaneCore</span><span class=o>::</span><span class=no>ConfigItem</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=ss>key</span><span class=p>:</span> <span class=ss>:arg2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		  <span class=ss>type</span><span class=p>:</span> <span class=nb>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>optional</span><span class=p>:</span> <span class=kp>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=ss>conflicting_options</span><span class=p>:</span> <span class=o>[</span><span class=ss>:arg1</span><span class=o>]</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nc>self</span><span class=o>.</span><span class=nf>verify_option</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>case</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>when</span> <span class=nb>String</span>
</span></span><span class=line><span class=cl>	    <span class=vc>@@polymophic_option</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>when</span> <span class=nb>Array</span>
</span></span><span class=line><span class=cl>    	<span class=vc>@@polymophic_option</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>when</span> <span class=no>Hash</span>
</span></span><span class=line><span class=cl>    	<span class=vc>@@polymophic_option</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>to_s</span>
</span></span><span class=line><span class=cl>	  <span class=k>else</span> 
</span></span><span class=line><span class=cl>    	<span class=no>UI</span><span class=o>.</span><span class=n>user_error!</span> <span class=s2>&#34;Invalid option: </span><span class=si>#{</span><span class=n>value</span><span class=o>.</span><span class=n>inspect</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer></footer></article><footer class=site-footer></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>